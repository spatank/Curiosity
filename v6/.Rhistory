getwd()
library(ggplot2)
library(psych)
library(reshape)
library(nlme)
data_1 <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data_v2.csv", header = TRUE)
data_2 <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data.csv", header = TRUE)
head(data_1)
head(data_2)
data_1 <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data_v2.csv", header = TRUE)
data_2 <- read.csv("/Volumes/My Passport/Curiosity//Data/KNOT_data_raw.csv", header = TRUE)
head(data_2)
all_data <- merge(data_1, data_2, by = "ID", all = TRUE)
head(all_data)
data_1 <- read.csv("/Volumes/My Passport/Curiosity//Data/KNOT_data_raw.csv", header = TRUE)
# from data_1 remove 5D
data_1 <- subset(data_1, select = -c(JE_5D, DS_5D, ST_5D, SC_5D, TS_5D))
head(data_1)
data_2 <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data_v2.csv", header = TRUE)
head(data_2)
all_data <- merge(data_1, data_2, by = "ID", all = TRUE)
head(all_data)
# create longitudinal plot for compressibility
plot_obs <- ggplot(data = all_data, aes(x = Node, y = C, group = ID))
print(plot_obs + geom_line())
# create longitudinal plot for Betti
plot_obs <- ggplot(data = all_data, aes(x = Node, y = Betti, group = ID))
print(plot_obs + geom_line())
data_1 <- read.csv("/Volumes/My Passport/Curiosity//Data/KNOT_data_raw.csv", header = TRUE)
# from data_1 remove 5D
data_1 <- subset(data_1, select = -c(SourceName, TargetName, JE_5D, DS_5D, ST_5D, SC_5D, TS_5D))
head(data_1)
data_2 <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data_v2.csv", header = TRUE)
head(data_2)
all_data <- merge(data_1, data_2, by = "ID", all = TRUE)
head(all_data)
data_2 <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data_v2.csv", header = TRUE)
head(data_2)
data_1 <- read.csv("/Volumes/My Passport/Curiosity//Data/KNOT_data_raw.csv", header = TRUE)
# from data_1 remove 5D
data_1 <- subset(data_1, select = -c(SourceName, TargetName, JE_5D, DS_5D, ST_5D, SC_5D, TS_5D, Day, TimeOrder, Hyperlink, DistanceWeights, Count, Weight))
head(data_1)
data_2 <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data_v2.csv", header = TRUE)
head(data_2)
all_data <- merge(data_1, data_2, by = "ID", all = TRUE)
head(all_data)
# create longitudinal plot for compressibility
plot_obs <- ggplot(data = all_data, aes(x = Node, y = C, group = ID))
print(plot_obs + geom_line())
# No growth model
betti_NG <- lme(fixed = Betti ~ 1,
data = all_data,
random = ~ 1 | ID,
na.action = na.omit)
summary(betti_NG)
all_data$pred_betti_NG <- predict(betti_NG)
all_data$resid_betti_NG <- residuals(betti_NG)
getwd()
library(ggplot2)
library(psych)
library(reshape)
library(nlme)
all_data <- read.csv("/Volumes/My Passport/Curiosity/v6/Data/KNOT/KNOT_data_v2.csv", header = TRUE)
head(all_data)
head(all_data)
# create longitudinal plot for compressibility
plot_obs <- ggplot(data = all_data, aes(x = Node, y = C, group = ID))
print(plot_obs + geom_line())
# create longitudinal plot for Betti
plot_obs <- ggplot(data = all_data, aes(x = Node, y = Betti, group = ID))
print(plot_obs + geom_line())
# No growth model
betti_NG <- lme(fixed = Betti ~ 1,
data = all_data,
random = ~ 1 | ID,
na.action = na.omit)
summary(betti_NG)
all_data$pred_betti_NG <- predict(betti_NG)
all_data$resid_betti_NG <- residuals(betti_NG)
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_NG, group = ID)) +
ggtitle("No Growth Model: Betti Curves") +
geom_point() +
geom_line() +
xlab("Node") +
ylab("PREDICTED Betti Curve") +
geom_hline(yintercept = 19.09, linetype = "dashed", color = "red")
# Linear growth
betti_LG <- lme(fixed = Betti ~ 1 + Node,
data = all_data,
random = ~ 1 | ID,
na.action = na.omit)
summary(betti_LG)
# Place individual predictions and residuals into the dataframe
all_data$pred_betti_LG <- predict(betti_LG)
all_data$resid_betti_LG <- residuals(betti_LG)
# Create a function for the prototype
fun_LG <- function(x) {
-11.85 + 0.407*x
}
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_LG, group = ID)) +
ggtitle("Linear Growth & Random Intercept") +
geom_point() +
geom_line() +
xlab("Node") +
ylab("PREDICTED Betti Curve") +
stat_function(fun = fun_LG, color = "red", size = 1, linetype = "dashed")
# Random slope
betti_LGRS <- lme(fixed = Betti ~ 1 + Node,
data = all_data,
random = ~ 1 + Node | ID,
na.action = na.omit)
summary(betti_LGRS)
# Place individual predictions and residuals into the dataframe
all_data$pred_betti_LGRS <- predict(betti_LGRS)
all_data$resid_betti_LGRS <- residuals(betti_LGRS)
# Create a function for the prototype
fun_LGRS <- function(x) {
-7.17 + 0.31*x
}
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_LGRS, group = ID)) +
ggtitle("Linear Growth, Random Intercept, Random Slope") +
geom_point() +
geom_line() +
xlab("Node") +
ylab("PREDICTED Betti Curve") +
stat_function(fun = fun_LGRS, color = "red", size = 1, linetype = "dashed")
# Quadratic growth
all_data$NodeQuad <- all_data$Node * all_data$Node
betti_QG <- lme(fixed = Betti ~ 1 + Node + NodeQuad,
data = all_data,
random = ~ 1 | ID,
na.action = na.omit)
summary(betti_QG)
# Place individual predictions and residuals into the dataframe
all_data$pred_betti_QG <- predict(betti_QG)
all_data$resid_betti_QG <- residuals(betti_QG)
# Create a function for the prototype
fun_QG <- function(x) {
-2.28 + 0.15*x + 0.00097*x*x
}
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_QG, group = ID)) +
ggtitle("Quadratic Growth") +
geom_point() +
geom_line() +
xlab("Node") +
ylab("PREDICTED Betti Curve") +
stat_function(fun = fun_QG, color = "red", size = 1, linetype = "dashed")
# Quadratic growth, random coefficients
betti_QGRS <- lme(fixed = Betti ~ 1 + Node + NodeQuad,
data = all_data,
random = ~ 1 + Node + NodeQuad | ID,
na.action = na.omit)
summary(betti_QGRS)
# Place individual predictions and residuals into the dataframe
all_data$pred_betti_QGRS <- predict(betti_QGRS)
all_data$resid_betti_QGRS <- residuals(betti_QGRS)
# Create a function for the prototype
fun_QGRS <- function(x) {
-0.575 + 0.069*x + 0.0018278*x*x
}
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_QGRS, group = ID)) +
ggtitle("Quadratic Growth, Random Intercept, Random Slope") +
geom_point() +
geom_line() +
xlab("Node") +
ylab("PREDICTED Betti Curve") +
stat_function(fun = fun_QGRS, color = "red", size = 1, linetype = "dashed")
betti_cur <- lme(fixed = Betti ~ 1 + Node + NodeQuad + DS + NodeQuad:DS + SC + NodeQuad:SC + ST + NodeQuad:ST + TS + NodeQuad:TS + JE + NodeQuad:JE + num_edges + NodeQuad:num_edges + num_nodes + NodeQuad:num_nodes,
data = all_data,
random = ~ 1 + Node + NodeQuad | ID,
na.action = na.omit)
summary(betti_cur)
# Place individual predictions and residuals into the dataframe
all_data$pred_betti_full <- predict(betti_cur)
all_data$resid_betti_full <- residuals(betti_cur)
plot(betti_cur)
ggplot(all_data, aes(x = all_data$resid_betti_full, y = pred_betti_full)) + geom_point()
# create longitudinal plot for Betti
plot_obs <- ggplot(data = all_data, aes(x = Node, y = Betti, group = ID))
print(plot_obs + geom_line())
betti_cur <- lme(fixed = Betti ~ 1 + Node + DS + Node:DS + num_edges + Node:num_edges + num_nodes + Node:num_nodes,
data = all_data,
random = ~ 1 + Node | ID,
na.action = na.omit)
summary(betti_cur)
# Place individual predictions and residuals into the dataframe
all_data$pred_betti_full <- predict(betti_cur)
all_data$resid_betti_full <- residuals(betti_cur)
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_full, group = ID)) +
ggtitle("Growth Model") +
geom_point() +
geom_line() +
xlab("Node") +
ylab("PREDICTED Betti Curve")
plot(betti_cur)
ggplot(all_data, aes(x = all_data$resid_betti_full, y = pred_betti_full)) + geom_point()
plot(betti_cur)
# Place individual predictions and residuals into the dataframe
all_data$pred_betti_full <- predict(betti_cur)
all_data$resid_betti_full <- residuals(betti_cur)
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_full, group = ID)) +
ggtitle("Growth Model") +
geom_point() +
geom_line() +
xlab("Node") +
ylab(
# plotting PREDICTED intra-individual change
ggplot(data = all_data, aes(x = Node, y = pred_betti_full, group = ID)) +
ggtitle("Growth Model") +
geom_point() +
geom_line() +
xlab("Node") +
ylab("PREDICTED Betti Curve")
plot(betti_cur)
ggplot(all_data, aes(x = all_data$resid_betti_full, y = pred_betti_full)) + geom_point()
# create longitudinal plot for Betti
plot_obs <- ggplot(data = all_data, aes(x = Node, y = Betti, group = ID))
print(plot_obs + geom_line())
betti_cur <- lme(fixed = Betti ~ 1 + Node + DS + Node:DS + num_edges + Node:num_edges + num_nodes + Node:num_nodes + AgeYears + SexOrient + Race + GenderFactor + EducDeg + Income,
data = all_data,
random = ~ 1 + Node | ID,
na.action = na.omit)
betti_cur <- lme(fixed = Betti ~ 1 + Node + DS + Node:DS + num_edges + Node:num_edges + num_nodes + Node:num_nodes + Age + SexOrient + Race + GenderFactor + EducDeg + Income,
data = all_data,
random = ~ 1 + Node | ID,
na.action = na.omit)
summary(betti_cur)
betti_cur <- lme(fixed = Betti ~ 1 + Node + NodeQuad + DS + NodeQuad:DS + SC + NodeQuad:SC + ST + NodeQuad:ST + TS + NodeQuad:TS + JE + NodeQuad:JE + num_edges + NodeQuad:num_edges + num_nodes + NodeQuad:num_nodes + Age + SexOrient + Race + GenderFactor + EducDeg + Income,
data = all_data,
random = ~ 1 + Node + NodeQuad | ID,
na.action = na.omit)
summary(betti_cur)
