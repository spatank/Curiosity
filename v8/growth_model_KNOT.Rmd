---
title: "Modeling for KNOT Data"
output: html_notebook
---

```{r}
getwd()
```

```{r}
library(ggplot2)
library(psych)
library(reshape)
library(nlme)
```

```{r}
all_data <- read.csv("/Volumes/My Passport/Curiosity/v8/Data/KNOT/processed_KNOT_data.csv", header = TRUE)
all_data$Gender <- as.factor(all_data$Gender)
```

```{r}
head(all_data)
```


```{r}
# create longitudinal plot for Betti 0
plot_obs <- ggplot(data = all_data, aes(x = Node, y = Betti_0, group = ID))
print(plot_obs + geom_line())
```


```{r}
model_1 <- lme(fixed = Betti_0 ~ 1 + Node*DS, 
              data = all_data,
              random = ~ 1 + Node | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_1)
```

```{r}
model_2 <- lme(fixed = Betti_0 ~ 1 + log(Node)*DS, 
              data = all_data,
              random = ~ 1 + log(Node) | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_2)
```

```{r}
all_data$NodeQuad <- all_data$Node * all_data$Node
model_3 <- lme(fixed = Betti_0 ~ 1 + NodeQuad*DS, 
              data = all_data,
              random = ~ 1 + NodeQuad | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_3)
```

```{r}
all_data$NodeQuad <- all_data$Node * all_data$Node
model_4 <- lme(fixed = Betti_0 ~ 1 + Node*DS + NodeQuad*DS, 
              data = all_data,
              random = ~ 1 + Node + NodeQuad | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_4)
```

```{r}
# create longitudinal plot for Betti 1
plot_obs <- ggplot(data = all_data, aes(x = Node, y = Betti_1, group = ID))
print(plot_obs + geom_line())
```

```{r}
model_5 <- lme(fixed = Betti_1 ~ 1 + Node*DS, 
              data = all_data,
              random = ~ 1 + Node | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_5)
```

```{r}
all_data$NodeQuad <- all_data$Node * all_data$Node
model_6 <- lme(fixed = Betti_1 ~ 1 + NodeQuad*DS, 
              data = all_data,
              random = ~ 1 + NodeQuad | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_6)
```

```{r}
all_data$NodeQuad <- all_data$Node * all_data$Node
model_7 <- lme(fixed = Betti_1 ~ 1 + Node*DS + NodeQuad*DS, 
              data = all_data,
              random = ~ 1 + Node + NodeQuad | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_7)
```

```{r}
# create longitudinal plot for Betti 2
plot_obs <- ggplot(data = all_data, aes(x = Node, y = Betti_2, group = ID))
print(plot_obs + geom_line())
```

```{r}
model_8 <- lme(fixed = Betti_2 ~ 1 + Node*DS, 
              data = all_data,
              random = ~ 1 + Node | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_8)
```

```{r}
all_data$NodeQuad <- all_data$Node * all_data$Node
model_9 <- lme(fixed = Betti_2 ~ 1 + NodeQuad*DS, 
              data = all_data,
              random = ~ 1 + NodeQuad | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_9)
```

```{r}
all_data$NodeQuad <- all_data$Node * all_data$Node
model_10 <- lme(fixed = Betti_2 ~ 1 + Node*DS + NodeQuad*DS, 
              data = all_data,
              random = ~ 1 + Node + NodeQuad | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_10)
```

```{r}
# create longitudinal plot for compressibility
plot_obs <- ggplot(data = all_data, aes(x = Node, y = C, group = ID))
print(plot_obs + geom_line())
```

```{r}
# create longitudinal plot for conformational degrees of freedom
plot_obs <- ggplot(data = all_data, aes(x = Node, y = DoF_C, group = ID))
print(plot_obs + geom_line())
```

```{r}
model_11 <- lme(fixed = DoF_C ~ 1 + Node*DS, 
              data = all_data,
              random = ~ 1 + Node | ID, 
              na.action = na.omit,
              control = lmeControl(opt = "optim"))
summary(model_11)
```

